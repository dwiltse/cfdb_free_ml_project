resources:
  jobs:
    cfdb_data_refresh:
      name: "CFDB Data Refresh - ${bundle.target}"
      tasks:
        - task_key: run_dlt_pipeline
          pipeline_task:
            pipeline_id: ${resources.pipelines.cfdb_dlt_pipeline.id}
      trigger:
        cron:
          quartz_cron_expression: "0 6 * * *"  # Daily at 6 AM
          timezone_id: "America/Chicago"
      email_notifications:
        on_failure:
          - "your-email@example.com"  # Replace with actual email
          
    cfdb_test_suite:
      name: "CFDB Pipeline Tests - ${bundle.target}"
      tasks:
        - task_key: run_unit_tests
          python_wheel_task:
            package_name: cfdb_free_ml_pipeline
            entry_point: "cfdb_pipeline.testing:run_unit_tests"
        - task_key: run_integration_tests
          depends_on:
            - task_key: run_unit_tests
          python_wheel_task:
            package_name: cfdb_free_ml_pipeline
            entry_point: "cfdb_pipeline.testing:run_integration_tests"
        - task_key: data_quality_checks
          depends_on:
            - task_key: run_integration_tests
          python_wheel_task:
            package_name: cfdb_free_ml_pipeline
            entry_point: "cfdb_pipeline.testing:run_data_quality_checks"